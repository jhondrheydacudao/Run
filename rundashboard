#!/bin/bash

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
CYAN='\033[0;36m'
NC='\033[0m' # No Color

# Clear screen
clear

# Check if running as root
if [ "$EUID" -ne 0 ]; then
  echo -e "${RED}Please run this script as root.${NC}"
  exit 1
fi

echo -e "${CYAN}Installing Dependencies...${NC}"

# Install required packages
sudo apt update
sudo apt install -y curl git software-properties-common
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs 

# Clone Hosting repository
echo -e "${CYAN}Cloning Hosting Repository...${NC}"
rm -rf Hosting # Remove old version if exists
git clone https://github.com/jhondrheydacudao/Hosting.git

# Go into Hosting directory
cd Hosting || { echo -e "${RED}Failed to enter Hosting directory!${NC}"; exit 1; }

# Install Node.js dependencies
echo -e "${CYAN}Installing Dependencies...${NC}"
npm install

# Install PM2 globally
echo -e "${CYAN}Installing PM2...${NC}"
sudo npm install -g pm2

# Start index.js with PM2
echo -e "${CYAN}Starting index.js with PM2...${NC}"
pm2 start index.js --name Hosting

# Save PM2 process
pm2 save

# Set PM2 to start on boot
pm2 startup systemd

echo -e "${GREEN}Hosting Panel is now running!${NC}"
